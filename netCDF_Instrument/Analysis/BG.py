'''
Created on Jul 28, 2014

@author: Gregory
'''
import numpy as np
class BG(object):
                    # Htr  H1     H2    H1/3   H1/10   H2%   H1%  H0.1%
        table = [0.05, 12.193, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.1, 7.003, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.15, 5.063, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.2, 4.022, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.25, 3.365, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.3, 2.908, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.35, 2.571, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.4, 2.311, 1.06, 1.279, 1.466, 1.548, 1.62, 1.813,
                    0.45, 2.104, 1.06, 1.279, 1.466, 1.549, 1.62, 1.813,
                    0.5, 1.936, 1.061, 1.28, 1.467, 1.549, 1.621, 1.814,
                    0.55, 1.796, 1.061, 1.281, 1.468, 1.55, 1.622, 1.815,
                    0.6, 1.678, 1.062, 1.282, 1.469, 1.552, 1.624, 1.817,
                    0.65, 1.578, 1.064, 1.284, 1.471, 1.554, 1.626, 1.82,
                    0.7, 1.492, 1.066, 1.286, 1.474, 1.557, 1.629, 1.823,
                    0.75, 1.419, 1.069, 1.29, 1.478, 1.561, 1.634, 1.828,
                    0.8, 1.356, 1.073, 1.294, 1.483, 1.567, 1.639, 1.835,
                    0.85, 1.302, 1.077, 1.3, 1.49, 1.573, 1.646, 1.843,
                    0.9, 1.256, 1.083, 1.307, 1.498, 1.582, 1.655, 1.852,
                    0.95, 1.216, 1.09, 1.315, 1.507, 1.591, 1.665, 1.864,
                    1, 1.182, 1.097, 1.324, 1.518, 1.603, 1.677, 1.877,
                    1.05, 1.153, 1.106, 1.335, 1.53, 1.616, 1.69, 1.892,
                    1.1, 1.128, 1.116, 1.346, 1.543, 1.63, 1.705, 1.909,
                    1.15, 1.108, 1.126, 1.359, 1.558, 1.645, 1.721, 1.927,
                    1.2, 1.09, 1.138, 1.371, 1.573, 1.662, 1.739, 1.946,
                    1.25, 1.075, 1.15, 1.381, 1.59, 1.679, 1.757, 1.967,
                    1.3, 1.063, 1.162, 1.389, 1.607, 1.698, 1.776, 1.988,
                    1.35, 1.052, 1.175, 1.395, 1.626, 1.717, 1.796, 2.011,
                    1.4, 1.043, 1.189, 1.399, 1.644, 1.737, 1.817, 2.034,
                    1.45, 1.036, 1.203, 1.403, 1.664, 1.757, 1.838, 2.058,
                    1.5, 1.03, 1.217, 1.406, 1.683, 1.778, 1.86, 2.082,
                    1.55, 1.024, 1.231, 1.408, 1.703, 1.799, 1.882, 2.106,
                    1.6, 1.02, 1.246, 1.41, 1.721, 1.82, 1.904, 2.131,
                    1.65, 1.016, 1.261, 1.411, 1.736, 1.841, 1.927, 2.156,
                    1.7, 1.013, 1.275, 1.412, 1.749, 1.863, 1.949, 2.182,
                    1.75, 1.011, 1.29, 1.413, 1.759, 1.884, 1.972, 2.207,
                    1.8, 1.009, 1.305, 1.413, 1.767, 1.906, 1.994, 2.232,
                    1.85, 1.007, 1.32, 1.414, 1.773, 1.927, 2.017, 2.257,
                    1.9, 1.006, 1.334, 1.414, 1.779, 1.949, 2.039, 2.282,
                    1.95, 1.004, 1.349, 1.415, 1.783, 1.97, 2.062, 2.307,
                    2, 1.004, 1.363, 1.415, 1.786, 1.985, 2.084, 2.332,
                    2.05, 1.003, 1.378, 1.415, 1.789, 1.983, 2.106, 2.357,
                    2.1, 1.002, 1.392, 1.415, 1.791, 1.982, 2.128, 2.382,
                    2.15, 1.002, 1.407, 1.415, 1.793, 1.981, 2.15, 2.406,
                    2.2, 1.001, 1.421, 1.415, 1.795, 1.981, 2.149, 2.43,
                    2.25, 1.001, 1.435, 1.415, 1.796, 1.98, 2.148, 2.454,
                    2.3, 1.001, 1.449, 1.415, 1.797, 1.979, 2.148, 2.478,
                    2.35, 1.001, 1.462, 1.415, 1.797, 1.979, 2.147, 2.502,
                    2.4, 1, 1.476, 1.416, 1.798, 1.979, 2.147, 2.525,
                    2.45, 1, 1.49, 1.416, 1.798, 1.979, 2.147, 2.548,
                    2.5, 1, 1.503, 1.416, 1.799, 1.978, 2.147, 2.571,
                    2.55, 1, 1.516, 1.416, 1.799, 1.978, 2.146, 2.593,
                    2.6, 1, 1.529, 1.416, 1.799, 1.978, 2.146, 2.616,
                    2.65, 1, 1.542, 1.416, 1.799, 1.978, 2.146, 2.629,
                    2.7, 1, 1.555, 1.416, 1.799, 1.978, 2.146, 2.629,
                    2.75, 1, 1.568, 1.416, 1.8, 1.978, 2.146, 2.628,
                    2.8, 1, 1.58, 1.416, 1.8, 1.978, 2.146, 2.628,
                    2.85, 1, 1.593, 1.416, 1.8, 1.978, 2.146, 2.628,
                    2.9, 1, 1.605, 1.416, 1.8, 1.978, 2.146, 2.628,
                    2.95, 1, 1.617, 1.416, 1.8, 1.978, 2.146, 2.628,
                    3, 1, 1.63, 1.416, 1.8, 1.978, 2.146, 2.628,
                    ]
        
        def __init__(self):
            pass
        
        def get_bg_value(self,htr,proba):
            j = -1
            if proba == 1: j = 1
            elif proba == 2: j = 2
            elif proba == 3: j = 3
            elif proba == 10: j = 4
            elif proba == 0.02: j = 5
            elif proba == 0.01: j = 6
            elif proba == 0.001: j = 7
            else: pass
            
            i = np.round(htr/0.05) - 1
            if htr > 3: i = 59
            elif htr < .05: i = 0
            else: pass
            
            if(j==-1):
                return np.NaN
            else:
                return self.table[i,j]
            
            